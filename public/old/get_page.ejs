<%

function get_params_by_page(html_code) {
	var image = $("#rescue-structure-img").attr("data-original");

	// Inizio tabella 1 **********
	var nome_cognome = $(".navbar-collapse .btn-primary").text().split(" ");
	var nome         = nome_cognome[0];
	var cognome      = nome_cognome[1];


	var table_1            = $(".col-md-12 table").first();
	var ruolo              = $(table_1).find(".glyphicon-user").parent().siblings().text();
	var dipartimento_full  = $(table_1).find(".glyphicon-home").parent().siblings().text().split("/");
	var dipartimento       = dipartimento_full[0];
	var dipartimento_sigla = dipartimento_full[1];

	var email = $(table_1).find(".glyphicon-envelope").parent().siblings().text();

 	var pos_ufficio_full = $(table_1).find(".glyphicon-map-marker").parent().siblings().text().split(", ");
	var pos_ufficio      =
	{
		campus: pos_ufficio_full[0],
	    edificio: pos_ufficio_full[1],
		piano: pos_ufficio_full[2],
		stanza: pos_ufficio_full[3]
	};
	console.log("Pos ufficio: " + pos_ufficio);
 
	var telephone={};
	$(table_1).find(".hidden-xs .glyphicon-earphone").each(function(index) {
		telephone[index] = $(this).parent().siblings().text();
	});
	var fax={};
	$(table_1).find(".glyphicon-print").each(function(index) {
		fax[index] = $(this).parent().siblings().text();
	});
	// Fine tabella 1 **********


	// Orario di ricevimento **********
	var office_hours=[];
	$(".col-md-12").find(".fa-calendar").each(function(index) {
		data_tab = $(this).parent().siblings();
		var day      = data_tab.eq(0).text();
		var hours    = data_tab.eq(1).text().split('-');
		var location = data_tab.eq(2).text();
	    var office_hour = {};
		office_hour['day']        = day;
		office_hour['start_hour'] = hours[0];
		office_hour['end_hour']   = hours[1];
		office_hour['location']   = location;
		office_hours[index] = office_hour;
	});
	console.log("Orari di ricevimento: " + office_hours);

	// Cose presenti raramente
	var link;
	$(".col-md-12").find(".fa-link").each(function(index) {
		link = $(this).parent().siblings().eq(0).children().attr('href');
		console.log("Homepage: " + link)
	});
	var orcid;
	$(".col-md-12").find(".fa-barcode").each(function(index) {
		orcid = $(this).parent().siblings().eq(0).children().attr('href');
		console.log("Orcid: " + orcid);
	});
	var announcements = [];
	$(".col-md-12").find(".fa-exclamation-circle").each(function(index) {
		link = $(this).parent().siblings().eq(0).find('a').attr('href');
		title = $(this).parent().siblings().eq(0).find('a').attr('title');
		var announcement = {};
		announcement['link']  = link;
		announcement['title'] = title;
		announcements[index]  = announcement;
	});
	console.log(announcements);
	var courses = [];
	$(".col-md-12").find(".panel-primary").each(function(index) {
		data_tab    = $(this).children();
		link        = data_tab.find('a').attr('href');
		nameCourse  = data_tab.find('a').text();
		codeCourse  = data_tab.find('small').text().split(' ');
		data_table  = $(this).find('table').children();
		department  = data_table.find('.fa-home').parent().siblings().text();
		levelDegree = data_table.find(".fa-graduation-cap").parent().siblings().text();
		kindDegree  = data_table.find(".fa-star").parent().siblings().eq(0).text();
		year        = data_table.find(".fa-star").parent().siblings().eq(1).text();
    		
		var course = {};
		course['nameCourse']=nameCourse;
		course['codeCourse']=codeCourse[1];
		course['linkCourse']=link;
		course['department']=department;
		course['levelDegree']=graduation;
		course['kindDegree']=typeDegree;
		course['year']=year;
		courses[index]=course;
	});
  
	// Object da restituire
	return page_obj = {
		nome: nome,
		cognome: cognome,
		ruolo: ruolo,
		dipartimento: dipartimento,
		dipartimento_sigla: dipartimento_sigla,
		email: email,
		pos_ufficio: pos_ufficio,
        telephone: telephone,
        office_hours: office_hours,
        link: link,
        orcid: orcid,
        image: image,
        fax: fax,
        announcements: announcements,
        courses: courses

	}
}



	console.log(courses);

	page_obj = get_params_by_page(html_code);

%>


<%- page_obj.nome %>
<br>
<%- page_obj.cognome %>
<br>
<%- page_obj.ruolo %>
<br>
<%- page_obj.dipartimento %>
<br>
<%- page_obj.dipartimento_sigla %>
<br>
<%- page_obj.pos_ufficio["campus"] %>
<br>
<%- page_obj.telephone[0] %>
<br>
<%- page_obj.fax[0] %>
<br>
<%- page_obj.image %>